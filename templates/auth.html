<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutenticaÃ§Ã£o - YouSong</title>
    <link rel="icon" href="{{ url_for('static', filename='img/logosmallbg.png') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/auth.css') }}">
</head>
<body>
    <div class="auth-background">
        <div class="animated-bg"></div>
    </div>
    
    <div class="auth-container">
        <div class="auth-card">
            <div class="logo-section">
                <img src="{{ url_for('static', filename='img/logo1.png') }}" class="auth-logo" alt="YouSong">
                <h1 class="app-title">YouSong</h1>
                <p class="app-subtitle">Sua mÃºsica, seu jeito</p>
            </div>

            <div class="tabs">
                <button class="tab active" data-tab="login">Login</button>
                <button class="tab" data-tab="register">Registar</button>
            </div>

            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="messages">
                {% for category, message in messages %}
                <div class="message {{ category }}">
                    <span class="message-icon">{{ 'âœ“' if category == 'success' else 'âœ•' }}</span>
                    <span>{{ message }}</span>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endwith %}

            <form method="POST" id="authForm" class="auth-form">
                <input type="hidden" name="action" value="login" id="actionInput">
                
                <div class="form-container" id="loginForm">
                    <div class="input-group">
                        <label for="loginUsername">Username</label>
                        <input type="text" name="username" id="loginUsername" required autocomplete="username">
                    </div>
                    <div class="input-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" name="password" id="loginPassword" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span class="btn-text">Entrar</span>
                        <span class="btn-icon">â†’</span>
                    </button>
                </div>

                <div class="form-container hidden" id="registerForm">
                    <div class="input-group">
                        <label for="registerUsername">Username</label>
                        <input type="text" name="username" id="registerUsername" minlength="3" autocomplete="username">
                    </div>
                    <div class="input-group">
                        <label for="registerPassword">Password</label>
                        <input type="password" name="password" id="registerPassword" minlength="6" autocomplete="new-password">
                    </div>
                    <div class="input-group">
                        <label for="confirmPassword">Confirmar Password</label>
                        <input type="password" name="confirm_password" id="confirmPassword" minlength="6" autocomplete="new-password">
                    </div>
                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span class="btn-text">Criar Conta</span>
                        <span class="btn-icon">â†’</span>
                    </button>
                </div>
            </form>

            <div class="auth-footer">
                <p class="secure-text">ðŸ”’ Seguro e encriptado</p>
            </div>
        </div>
    </div>

    <script>
        const tabs = document.querySelectorAll('.tab');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const actionInput = document.getElementById('actionInput');
        const authForm = document.getElementById('authForm');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabType = tab.dataset.tab;
                
                // Update tab styles
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Switch forms
                if (tabType === 'login') {
                    loginForm.classList.remove('hidden');
                    registerForm.classList.add('hidden');
                    actionInput.value = 'login';
                    
                    // Reset required attributes
                    document.getElementById('loginUsername').required = true;
                    document.getElementById('loginPassword').required = true;
                    document.getElementById('registerUsername').required = false;
                    document.getElementById('registerPassword').required = false;
                    document.getElementById('confirmPassword').required = false;
                } else {
                    loginForm.classList.add('hidden');
                    registerForm.classList.remove('hidden');
                    actionInput.value = 'register';
                    
                    // Reset required attributes
                    document.getElementById('loginUsername').required = false;
                    document.getElementById('loginPassword').required = false;
                    document.getElementById('registerUsername').required = true;
                    document.getElementById('registerPassword').required = true;
                    document.getElementById('confirmPassword').required = true;
                }
            });
        });

        // Form submission animation
        authForm.addEventListener('submit', (e) => {
            const submitBtn = e.target.querySelector('.submit-btn');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
        });

        // Animated background
        const animatedBg = document.querySelector('.animated-bg');
        for (let i = 0; i < 50; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 20 + 's';
            particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
            animatedBg.appendChild(particle);
        }
    </script>
</body>
</html>